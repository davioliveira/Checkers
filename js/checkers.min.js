/*
* piecePosition = {row: ?, column: ?}
* TOP_PLAYER = BLUE
* BOTTOM_PLAYER = RED
* */function getMoveActions(e,t){return pieceIsLady(t)?getLadyPieceMoveActions(e,t):getNormalPieceMoveActions(e,t)}function pieceIsLady(e){return table[e.row][e.column]>1}function isLadyPosition(e,t){return t==TOP_PLAYER&&e.row==table.length-1||t==BOTTOM_PLAYER&&e.row==0}function getLadyPieceMoveActions(e,t){var n=[];t.row=Number(t.row);t.column=Number(t.column);var r=[{direction:SE,type:MOVE_PIECE,row:t.row+1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{direction:SO,type:MOVE_PIECE,row:t.row+1,column:t.column-1,fromRow:t.row,fromColumn:t.column},{direction:NE,type:MOVE_PIECE,row:t.row-1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{direction:NO,type:MOVE_PIECE,row:t.row-1,column:t.column-1,fromRow:t.row,fromColumn:t.column}],i;for(var s=0,i=r.length;s<i;s++){var o=r[s];try{while(e[o.row][o.column]==EMPTY_CELL){var u=copyTable(e);u[o.row][o.column]=u[t.row][t.column];u[t.row][t.column]=EMPTY_CELL;n.push({type:MOVE_PIECE,row:o.row,column:o.column,fromRow:t.row,fromColumn:t.column,table:u,direction:o.direction});addCoordinates(o,o.direction)}}catch(a){}}return n}function getNormalPieceMoveActions(e,t){var n=[],r=e[t.row][t.column],i=getDiagonalMoves(r,t),s;for(var o=0,s=i.length;o<s;o++)try{var u=copyTable(e),a=i[o];if(e[a.row][a.column]==EMPTY_CELL){u[a.row][a.column]=r;isLadyPosition(a,r)&&r<=1&&(u[a.row][a.column]+=LADY_ADD_VALUE);u[t.row][t.column]=EMPTY_CELL;a.table=u;n.push(a)}}catch(f){}return n}function getEatActions(e,t,n,r,i){return pieceIsLady(t)?getLadyEatActions(e,t,n,r,i):getNormalEatActions(e,t,n,r,i)}function getLadyEatActions(e,t,n,r,i){var s=getLadyPieceMoveActions(table,t),o=[],u;for(var a=0,u=s.length;a<u;a++)concatLists(o,getLadyEatActionsRecursive(e,s[a],n,r,i,e[i.row][i.column],0));concatLists(o,getNormalEatActions(e,t,[],[],i));return o}function getLadyEatActionsRecursive(e,t,n,r,i,s,o){var u=[];if(o==0){var a={row:t.row,column:t.column,type:MOVE_PIECE};addCoordinates(a,t.direction);var f=[a]}else var f=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,direction:SE},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,direction:SO},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,direction:NO},{type:MOVE_PIECE,row:t.row-1,column:t.column+1,direction:NE}];var l;for(var c=0,l=f.length;c<l;c++)try{if(e[f[c].row][f[c].column]!=EMPTY_CELL&&e[f[c].row][f[c].column]!=s&&e[f[c].row][f[c].column]!=s+LADY_ADD_VALUE&&e[f[c].row][f[c].column]!=s-LADY_ADD_VALUE){var h={row:f[c].row,column:f[c].column};o==0?addCoordinates(h,t.direction):addCoordinates(h,f[c].direction);if(e[h.row][h.column]==EMPTY_CELL){var p=copyTable(e);p[h.row][h.column]=s;p[f[c].row][f[c].column]=EMPTY_CELL;p[t.row][t.column]=EMPTY_CELL;var d=copyNodeList(n);d.push(h);var v=copyNodeList(r);v.push(f[c]);var m={type:EAT_PIECE,movementPositions:d,removedPiecesPosition:v,table:p,fromRow:i.row,fromColumn:i.column};o++;u.push(m);concatLists(u,getLadyEatActionsRecursive(p,h,d,v,i,s,o))}}}catch(g){}return u}function getNormalEatActions(e,t,n,r,i){var s=[],o=e[t.row][t.column],u=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,direction:SE},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,direction:SO},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,direction:NO},{type:MOVE_PIECE,row:t.row-1,column:t.column+1,direction:NE}],a;for(var f=0,a=u.length;f<a;f++)try{if(e[u[f].row][u[f].column]!=EMPTY_CELL&&e[u[f].row][u[f].column]!=o&&e[u[f].row][u[f].column]!=o+LADY_ADD_VALUE&&e[u[f].row][u[f].column]!=o-LADY_ADD_VALUE){var l={row:u[f].row,column:u[f].column};addCoordinates(l,u[f].direction);if(e[l.row][l.column]==EMPTY_CELL){var c=copyTable(e);c[l.row][l.column]=o;c[u[f].row][u[f].column]=EMPTY_CELL;c[t.row][t.column]=EMPTY_CELL;var h=copyNodeList(n);h.push(l);var p=copyNodeList(r);p.push(u[f]);var d={type:EAT_PIECE,movementPositions:h,removedPiecesPosition:p,table:c,fromRow:i.row,fromColumn:i.column};isLadyPosition(l,o)&&(d.table[l.row][l.column]+=LADY_ADD_VALUE);s.push(d);concatLists(s,getNormalEatActions(c,l,h,p,i))}}}catch(v){}return s}function getDiagonalMoves(e,t){t.row=Number(t.row);t.column=Number(t.column);if(e==TOP_PLAYER)var n=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,fromRow:t.row,fromColumn:t.column}];else var n=[{type:MOVE_PIECE,row:t.row-1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,fromRow:t.row,fromColumn:t.column}];return n}function hasWinner(e){var t=!1,n=!1,r;for(var i=0,r=e.length;i<r&&(!t||!n);i++){var s;for(var o=0,s=e[0].length;o<s&&(!t||!n);o++)if(e[i][o]==TOP_PLAYER||e[i][o]==LADY_TOP_PLAYER)t=!0;else if(e[i][o]==BOTTOM_PLAYER||e[i][o]==LADY_BOTTOM_PLAYER)n=!0}return t&&!n?TOP_PLAYER:!t&&n?BOTTOM_PLAYER:null}function checkWinner(e,t){var n=getPossibleMovements(e,t);return n.length==0?t==TOP_PLAYER?BOTTOM_PLAYER:TOP_PLAYER:hasWinner(e)}function concatLists(e,t){var n;for(var r=0,n=t.length;r<n;r++)e.push(t[r])}function copyTable(e){var t=[],n,r;for(var i=0,n=e.length;i<n;i++){var s=[];for(var o=0,r=e[0].length;o<r;o++)s[o]=e[i][o];t[i]=s}return t}function copyNodeList(e){var t=[],n;for(var r=0,n=e.length;r<n;r++)t[r]={row:e[r].row,column:e[r].column};return t}function getPlayerPiecesPosition(e,t){var n=[],r,i;for(var s=0,r=e.length;s<r;s++)for(var o=0,i=e[0].length;o<i;o++)(e[s][o]==t||e[s][o]==t+LADY_ADD_VALUE||e[s][o]==t-LADY_ADD_VALUE)&&n.push({row:s,column:o});return n}function getPossibleMovements(e,t){var n=getPlayerPiecesPosition(e,t),r=[],i=n.length;for(var s=0;s<i;s++){var o=n[s],u=getMoveActions(e,o),a=getEatActions(e,o,[],[],o);concatLists(a,u);concatLists(r,a)}i=r.length;for(var f=0;f<i;f++)r[f].value=utility(r[f].table,t);r.sort(function(e,t){return t.value-e.value});return r}function getTotalPieces(e){var t,n,r=0;for(var i=0,t=e.length;i<t;i++)for(var s=0,n=e[0].length;s<n;s++)e[i][s]!=EMPTY_CELL&&r++;return r}function iaMove(e){var t=minimaxDecision(table,e);t.type==MOVE_PIECE?movePiece({row:t.fromRow,column:t.fromColumn},[{row:t.row,column:t.column}],[]):movePiece({row:t.fromRow,column:t.fromColumn},t.movementPositions,t.removedPiecesPosition)}function getEnemyPlayer(e){return e==TOP_PLAYER?BOTTOM_PLAYER:TOP_PLAYER}function addCoordinates(e,t){e.row=e.row+t.row;e.column=e.column+t.column};