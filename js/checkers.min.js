/*
* piecePosition = {row: ?, column: ?}
* TOP_PLAYER = BLUE
* BOTTOM_PLAYER = RED
* */function getMoveActions(e,t){return pieceIsLady(t)?getLadyPieceMoveActions(e,t):getNormalPieceMoveActions(e,t)}function pieceIsLady(e){return table[e.row][e.column]>1}function isLadyPosition(e,t){return t==TOP_PLAYER&&e.row==table.length-1||t==BOTTOM_PLAYER&&e.row==0}function getLadyPieceMoveActions(e,t){var n=[];t.row=Number(t.row);t.column=Number(t.column);var r=[{direction:SE,type:MOVE_PIECE,row:t.row+1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{direction:SO,type:MOVE_PIECE,row:t.row+1,column:t.column-1,fromRow:t.row,fromColumn:t.column},{direction:NE,type:MOVE_PIECE,row:t.row-1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{direction:NO,type:MOVE_PIECE,row:t.row-1,column:t.column-1,fromRow:t.row,fromColumn:t.column}];for(var i=0;i<r.length;i++){var s=r[i];try{while(e[s.row][s.column]==EMPTY_CELL){var o=copyTable(e);o[s.row][s.column]=o[t.row][t.column];o[t.row][t.column]=EMPTY_CELL;n.push({type:MOVE_PIECE,row:s.row,column:s.column,fromRow:t.row,fromColumn:t.column,table:o,direction:s.direction});addCoordinates(s,s.direction)}}catch(u){}}return n}function getNormalPieceMoveActions(e,t){var n=[],r=e[t.row][t.column],i=getDiagonalMoves(r,t);for(var s=0;s<i.length;s++)try{var o=copyTable(e),u=i[s];if(e[u.row][u.column]==EMPTY_CELL){o[u.row][u.column]=r;isLadyPosition(t,r)&&(o[u.row][u.column]+=LADY_ADD_VALUE);o[t.row][t.column]=EMPTY_CELL;u.table=o;n.push(u)}}catch(a){}return n}function getEatActions(e,t,n,r,i){return pieceIsLady(t)?getLadyEatActions(e,t,n,r,i):getNormalEatActions(e,t,n,r,i)}function getLadyEatActions(e,t,n,r,i){var s=getLadyPieceMoveActions(table,t),o=[];for(var u=0;u<s.length;u++)concatLists(o,getLadyEatActionsRecursive(e,s[u],n,r,i,e[i.row][i.column],0));concatLists(o,getNormalEatActions(e,t,[],[],i));return o}function getLadyEatActionsRecursive(e,t,n,r,i,s,o){var u=[];if(o==0){var a={row:t.row,column:t.column,type:MOVE_PIECE};addCoordinates(a,t.direction);var f=[a]}else var f=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,direction:SE},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,direction:SO},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,direction:NO},{type:MOVE_PIECE,row:t.row-1,column:t.column+1,direction:NE}];for(var l=0;l<f.length;l++)try{if(e[f[l].row][f[l].column]!=EMPTY_CELL&&e[f[l].row][f[l].column]!=s&&e[f[l].row][f[l].column]!=s+LADY_ADD_VALUE&&e[f[l].row][f[l].column]!=s-LADY_ADD_VALUE){var c={row:f[l].row,column:f[l].column};o==0?addCoordinates(c,t.direction):addCoordinates(c,f[l].direction);if(e[c.row][c.column]==EMPTY_CELL){var h=copyTable(e);h[c.row][c.column]=s;h[f[l].row][f[l].column]=EMPTY_CELL;h[t.row][t.column]=EMPTY_CELL;var p=copyNodeList(n);p.push(c);var d=copyNodeList(r);d.push(f[l]);var v={type:EAT_PIECE,movementPositions:p,removedPiecesPosition:d,table:h,fromRow:i.row,fromColumn:i.column};o++;u.push(v);concatLists(u,getLadyEatActionsRecursive(h,c,p,d,i,s,o))}}}catch(m){}return u}function getNormalEatActions(e,t,n,r,i){var s=[],o=e[t.row][t.column],u=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,direction:SE},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,direction:SO},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,direction:NO},{type:MOVE_PIECE,row:t.row-1,column:t.column+1,direction:NE}];for(var a=0;a<u.length;a++)try{if(e[u[a].row][u[a].column]!=EMPTY_CELL&&e[u[a].row][u[a].column]!=o&&e[u[a].row][u[a].column]!=o+LADY_ADD_VALUE&&e[u[a].row][u[a].column]!=o-LADY_ADD_VALUE){var f={row:u[a].row,column:u[a].column};addCoordinates(f,u[a].direction);if(e[f.row][f.column]==EMPTY_CELL){var l=copyTable(e);l[f.row][f.column]=o;l[u[a].row][u[a].column]=EMPTY_CELL;l[t.row][t.column]=EMPTY_CELL;var c=copyNodeList(n);c.push(f);var h=copyNodeList(r);h.push(u[a]);var p={type:EAT_PIECE,movementPositions:c,removedPiecesPosition:h,table:l,fromRow:i.row,fromColumn:i.column};isLadyPosition(f,o)&&(p.table[f.row][f.column]+=LADY_ADD_VALUE);s.push(p);concatLists(s,getNormalEatActions(l,f,c,h,i))}}}catch(d){}return s}function getDiagonalMoves(e,t){t.row=Number(t.row);t.column=Number(t.column);if(e==TOP_PLAYER)var n=[{type:MOVE_PIECE,row:t.row+1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{type:MOVE_PIECE,row:t.row+1,column:t.column-1,fromRow:t.row,fromColumn:t.column}];else var n=[{type:MOVE_PIECE,row:t.row-1,column:t.column+1,fromRow:t.row,fromColumn:t.column},{type:MOVE_PIECE,row:t.row-1,column:t.column-1,fromRow:t.row,fromColumn:t.column}];return n}function hasWinner(e){var t=!1,n=!1;for(var r=0;r<e.length&&(!t||!n);r++)for(var i=0;i<e[0].length&&(!t||!n);i++)e[r][i]==TOP_PLAYER?t=!0:e[r][i]==BOTTOM_PLAYER&&(n=!0);return t&&!n?TOP_PLAYER:!t&&n?BOTTOM_PLAYER:null}function concatLists(e,t){for(var n=0;n<t.length;n++)e.push(t[n])}function copyTable(e){var t=[];for(var n=0;n<e.length;n++){var r=[];for(var i=0;i<e[0].length;i++)r[i]=e[n][i];t[n]=r}return t}function copyNodeList(e){var t=[];for(var n=0;n<e.length;n++)t[n]={row:e[n].row,column:e[n].column};return t}function getPlayerPiecesPosition(e,t){var n=[];for(var r=0;r<e.length;r++)for(var i=0;i<e[0].length;i++)e[r][i]==t&&n.push({row:r,column:i});return n}function getPossibleMovements(e,t){var n=getPlayerPiecesPosition(e,t),r=[];for(var i=0;i<n.length;i++){var s=n[i],o=getMoveActions(e,s),u=getEatActions(e,s,[],[],s);concatLists(u,o);concatLists(r,u)}return r}function iaMove(){var e=minimaxDecision(table);e.type==MOVE_PIECE?movePiece({row:e.fromRow,column:e.fromColumn},[{row:e.row,column:e.column}],[]):movePiece({row:e.fromRow,column:e.fromColumn},e.movementPositions,e.removedPiecesPosition)}function addCoordinates(e,t){e.row=e.row+t.row;e.column=e.column+t.column};