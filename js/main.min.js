function initGame(){initTable();initPieces();addEventListeners()}function addEventListeners(){$(".checkers-cell").click(function(){handleCellClick(this)});$(".checkers-piece").click(function(){handlePieceClick(this)})}function handleCellClick(e){var t=$(".checkers-piece.selected");if(t){var n=t.parent(".checkers-column").attr("data-column"),r=t.parent(".checkers-column").parent(".checkers-row").attr("data-row"),i={row:r,column:n},s=$(e).attr("data-column"),o=$(e).parent(".checkers-row").attr("data-row"),u={row:o,column:s},a=getMoveActions(table,i),f=getEatActions(table,i,[],[]);if(a.length>0)for(var l=0;l<a.length;l++)if(a[l].row==u.row&&a[l].column==u.column){movePiece(i,u);return}if(f.length>0)for(var l=0;l<f.length;l++){var c=f[l],h=c.movementPositions[c.movementPositions.length-1];h.row==u.row&&h.column==u.column&&eatPiece(i,c)}}}function handlePieceClick(e){var t=$(e).hasClass("selected");$(".checkers-piece").each(function(e){$(this).removeClass("selected")});t||$(e).toggleClass("selected")}function initTable(){initTableStructure(tableSize);var e="";for(var t=0;t<table.length;t++){var n=t%2,r="<div class='checkers-row' data-row='"+t+"'>";for(var i=0;i<table[t].length;i++){n=!n;var s="<div data-color='"+n+"' data-column='"+i+"' class='checkers-cell checkers-column'></div>";r+=s}r+="</div>";e+=r;e+="<div class='clear-fix'></div>"}$("#checkersTable").html(e)}function initTableStructure(e){var t,n;for(t=0;t<e;t++){var r=[];for(n=0;n<e;n++)r[n]=-1;table.push(r)}}function initPieces(){var e=(tableSize-2)/2,t="<div data-color='#color#' class='checkers-piece'></div>";for(var n=0;n<e;n++)for(var r=n%2;r<tableSize;r+=2){table[n][r]=TOP_PLAYER;$("div[data-row='"+n+"'] .checkers-cell[data-column='"+r+"']").html(t.replace("#color#",TOP_PLAYER))}for(var n=e+2;n<tableSize;n++)for(var r=n%2;r<tableSize;r+=2){table[n][r]=BOTTOM_PLAYER;$("div[data-row='"+n+"'] .checkers-cell[data-column='"+r+"']").html(t.replace("#color#",BOTTOM_PLAYER))}}function eatPiece(e,t){var n=e;for(var r=0;r<t.movementPositions.length;r++){movePiece(n,t.movementPositions[r]);removePiece(t.removedPiecesPosition[r]);n=t.movementPositions[r]}}function removePiece(e){$("div[data-row='"+e.row+"'] .checkers-cell[data-column='"+e.column+"']").html("");table[e.row][e.column]=EMPTY_CELL}function movePiece(e,t){var n=$("div[data-row='"+e.row+"'] .checkers-cell[data-column='"+e.column+"']").find(".checkers-piece");if(n){var r=$("div[data-row='"+e.row+"'] .checkers-cell[data-column='"+e.column+"']").html(),i=$("div[data-row='"+t.row+"'] .checkers-cell[data-column='"+t.column+"']").position(),s=n.position().left+"px",o=n.position().top+"px";n.css({position:"absolute",left:s,top:o});n.animate({left:i.left+12+"px",top:i.top+"px"},ANIMATION_SPEED,function(){$("div[data-row='"+t.row+"'] .checkers-cell[data-column='"+t.column+"']").html(r);$("div[data-row='"+e.row+"'] .checkers-cell[data-column='"+e.column+"']").html("");n=$("div[data-row='"+t.row+"'] .checkers-cell[data-column='"+t.column+"']").find(".checkers-piece");n.click(function(){handlePieceClick(this)});table[t.row][t.column]=table[e.row][e.column];table[e.row][e.column]=-1;callback()})}}var table=[],tableSize=8,ANIMATION_SPEED=500;